# コンポーネントのコーディングガイド

本プロジェクトでは、コード品質を保つために以下のコーディングルールを定めています。これらのルールに従い、可読性や保守性の高いコードを目指します。

## 1. コンポーネントの行数制限

Reactコンポーネントは**80行以内**を目安とし、超える場合は以下を検討する：

- カスタムフックへの切り出し（`logics/`フォルダ）
- ロジックを別ファイルに分離（`logics/`フォルダ）
- 子コンポーネントへの分割（`parts/`フォルダまたは機能分解）

```tsx
// 良い例：カスタムフックでロジックを分離
const useUserProfile = (userId: string) => {
  const [user, setUser] = useState<User | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    fetchUser(userId).then(setUser).finally(() => setLoading(false));
  }, [userId]);

  return { user, loading };
};

const UserProfile = ({ userId }: { userId: string }) => {
  const { user, loading } = useUserProfile(userId);

  if (loading) return <div>Loading...</div>;
  if (!user) return <div>User not found</div>;

  return (
    <div className="user-profile">
      <h1>{user.name}</h1>
      <p>{user.email}</p>
    </div>
  );
};
```

## 2. スタイリング方法

### 2.1 基本方針

- **`react-aria-components` を使用し、ロジックとアクセシビリティを担保**
- スタイリングは `className` にCSSクラス名を指定
- コンポーネントファイルに隣接してCSSファイルを配置
- `@scope`を利用したスコープ化を実装

### 2.1.1 コンポーネント実装

- **インタラクティブなUI**: `react-aria-components` の `Button`, `Dialog`, `Slider` などを利用
- **独自の画像処理UI**: `ui/primitives/`で独自実装
- **機能固有UI**: `ui/features/`で `react-aria-components` と独自コンポーネントを組み合わせ

### 2.2 ファイル構成例

```
ui/features/ または ui/primitives/
├── UserCard/
│   ├── UserCard.tsx
│   ├── UserCard.test.tsx      # 単体テスト
│   ├── UserCard.css
│   ├── UserCard.stories.tsx   # Storybook用（ui/primitives/の場合）
│   ├── defs/                  # 型・定数（ui/features/の場合）
│   │   ├── UserCardTypes.ts
│   │   └── userCardConstants.ts
│   └── index.ts
```

### 2.3 コンポーネント実装例

```tsx
// UserCard.tsx
import './UserCard.css';

interface UserCardProps {
  name: string;
  email: string;
  avatar?: string;
}

export const UserCard = ({ name, email, avatar }: UserCardProps) => {
  return (
    <div className="user-card">
      <div className="user-card__avatar">
        {avatar ? <img src={avatar} alt="" /> : <div className="placeholder" />}
      </div>
      <div className="user-card__content">
        <h3 className="user-card__name">{name}</h3>
        <p className="user-card__email">{email}</p>
        <button type="button">詳細を見る</button>
      </div>
    </div>
  );
};
```

### 2.4 CSS実装例

```css
/* UserCard.css */
@scope (.user-card) {
  /* presentation要素にはクラス名を使用 */
  .user-card__avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    overflow: hidden;
  }

  .user-card__content {
    flex: 1;
    padding: 0 16px;
  }

  .user-card__name {
    margin: 0 0 8px 0;
    font-size: 18px;
    font-weight: 600;
  }

  .user-card__email {
    margin: 0 0 16px 0;
    color: #666;
  }

  .placeholder {
    width: 100%;
    height: 100%;
    background: #f0f0f0;
  }

  /* セマンティック要素には要素型セレクターを使用 */
  button {
    padding: 8px 16px;
    background: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  button:hover {
    background: #0056b3;
  }

  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
}
```

## 3. スタイリングルール

### 3.1 要素選択の基本原則

- **presentation要素**（`div`, `span`など）：CSSクラス名を使用
- ［任意］**セマンティック要素** （`button`, `input`, `h1-h6`など）：要素型セレクターを使用

### 3.2 同じロールの兄弟要素がある場合

```tsx
// 複数のボタンがあり、スタイルが異なる場合
<div className="action-buttons">
  <button type="button" className="primary">保存</button>
  <button type="button" className="secondary">キャンセル</button>
</div>
```

```css
@scope (.action-buttons) {
  button {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  button.primary {
    background: #007bff;
    color: white;
  }

  button.secondary {
    background: #6c757d;
    color: white;
  }
}
```